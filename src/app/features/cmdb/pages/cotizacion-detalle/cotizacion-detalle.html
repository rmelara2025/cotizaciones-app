<div class="detalle-container" [class.modal-mode]="isModal">

    <div *ngIf="error" class="error-message p-3">
        <p style="color: #e53238;">⚠️ {{ error }}</p>
    </div>

    <div *ngIf="loading" class="loading p-3">
        <p>Cargando detalles...</p>
    </div>

    <div *ngIf="detalle && detalle.length > 0 && !loading" [class.p-4]="!isModal">
        <p-table [value]="detalle" dataKey="idDetalle" [tableStyleClass]="'p-datatable-striped'" [loading]="loading"
            [paginator]="true" [rows]="pageSize" [totalRecords]="totalRecords" [lazy]="true" [first]="currentFirst"
            (onLazyLoad)="onPageChange($event)">
            <ng-template pTemplate="header">
                <tr>
                    <th>#</th>
                    <th>Servicio</th>
                    <th>Familia</th>
                    <th style="text-align: right;">Cantidad</th>
                    <th style="text-align: right;">Recurrente</th>
                    <th>Moneda</th>
                    <th>Acciones</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-det>
                <tr>
                    <td>{{ det.numItem }}</td>
                    <td>{{ det.nombreServicio }}</td>
                    <td>{{ det.nombreFamilia }}</td>
                    <td style="text-align: right;">{{ det.cantidad }}</td>
                    <td style="text-align: right;">{{ convertCurrency(det)}}</td>
                    <td>{{ det.nombreTipoMoneda }}</td>
                    <td>
                        <p-button icon="pi pi-pencil" [raised]="true" pTooltip="Modificar" [rounded]="true" size="small"
                            class="p-1" severity="warn"></p-button>
                        <p-button icon="pi pi-trash" [raised]="true" pTooltip="Borrar" [rounded]="true" size="small"
                            severity="danger"></p-button>
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
                <tr>
                    <td colspan="7">No hay detalles disponibles</td>
                </tr>
            </ng-template>
        </p-table>
    </div>

    <div *ngIf="!detalle || detalle.length === 0 && !loading && !error" class="p-3">
        <p>No se encontraron detalles para esta cotización.</p>
    </div>
</div>